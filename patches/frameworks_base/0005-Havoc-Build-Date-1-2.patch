From e19df9ffeef3dc818b71125671074c3134bafd7f Mon Sep 17 00:00:00 2001
From: Kazakov Stepan <ksrt12group@gmail.com>
Date: Sun, 23 Dec 2018 21:16:57 +0300
Subject: [PATCH] Havoc Build Date [1/2]

Signed-off-by: Kazakov Stepan <ksrt12group@gmail.com>
---
 core/java/android/os/Build.java                 |  6 ++++++
 .../android/settingslib/DeviceInfoUtils.java    | 17 +++++++++++++++++
 2 files changed, 23 insertions(+)

diff --git a/core/java/android/os/Build.java b/core/java/android/os/Build.java
index bd2d1c81d14..2a074d05d2a 100644
--- a/core/java/android/os/Build.java
+++ b/core/java/android/os/Build.java
@@ -216,6 +216,12 @@ public class Build {
         public static final String SECURITY_PATCH = SystemProperties.get(
                 "ro.build.version.security_patch", "");
 
+        /**
+         * The build date.
+         */
+        public static final String HAVOC_BUILD_DATE = SystemProperties.get(
+                "ro.havoc.build.date", "");
+
         /**
          * The user-visible SDK version of the framework in its raw String
          * representation; use {@link #SDK_INT} instead.
diff --git a/packages/SettingsLib/src/com/android/settingslib/DeviceInfoUtils.java b/packages/SettingsLib/src/com/android/settingslib/DeviceInfoUtils.java
index f2cd1033cd3..b33fec3557c 100644
--- a/packages/SettingsLib/src/com/android/settingslib/DeviceInfoUtils.java
+++ b/packages/SettingsLib/src/com/android/settingslib/DeviceInfoUtils.java
@@ -169,6 +169,23 @@ public class DeviceInfoUtils {
         }
     }
 
+    public static String getHavocBuildDate() {
+        String havocbuild = Build.VERSION.HAVOC_BUILD_DATE;
+        if (!"".equals(havocbuild)) {
+            try {
+                SimpleDateFormat template = new SimpleDateFormat("dd-MM-yyyy");
+                Date havocbuildDate = template.parse(havocbuild);
+                String format = DateFormat.getBestDateTimePattern(Locale.getDefault(), "dMMMMyyyy");
+                havocbuild = DateFormat.format(format, havocbuildDate).toString();
+            } catch (ParseException e) {
+                // broken parse; fall through and use the raw string
+            }
+            return havocbuild;
+        } else {
+            return null;
+        }
+    }
+
     public static String getFormattedPhoneNumber(Context context, SubscriptionInfo subscriptionInfo) {
         String formattedNumber = null;
         if (subscriptionInfo != null) {
-- 
2.19.1

